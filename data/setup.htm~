<html>
 <head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Дополнительные настройки</title>
  <script>
   var xmlHttp=createXmlHttpObject();
   function createXmlHttpObject(){
    if(window.XMLHttpRequest){
     xmlHttp=new XMLHttpRequest();
    }else{
     xmlHttp=new ActiveXObject('Microsoft.XMLHTTP');
    }
    return xmlHttp;
   }
   function load(){
    if(xmlHttp.readyState==0 || xmlHttp.readyState==4){
     xmlHttp.open('PUT','configxml',true);
     xmlHttp.onreadystatechange=handleServerResponse;
     xmlHttp.send(null);
    }
   }
   function handleServerResponse(){
    if(xmlHttp.readyState==4 && xmlHttp.status==200){
     xmlResponse=xmlHttp.responseXML;

     xmldoc = xmlResponse.getElementsByTagName('timezone');
     message = xmldoc[0].firstChild.nodeValue;
     document.getElementById('timezone').value=message;

     xmldoc = xmlResponse.getElementsByTagName('ssid');
     message = xmldoc[0].firstChild.nodeValue;
     document.getElementById('ssid').value=message;

     xmldoc = xmlResponse.getElementsByTagName('password');
     message = xmldoc[0].firstChild.nodeValue;
     document.getElementById('password').value=message;

     xmldoc = xmlResponse.getElementsByTagName('ssidAP');
     message = xmldoc[0].firstChild.nodeValue;
     document.getElementById('ssidap').value=message;

     xmldoc = xmlResponse.getElementsByTagName('passwordAP');
     message = xmldoc[0].firstChild.nodeValue;
     document.getElementById('passwordAp').value=message;

     xmldoc = xmlResponse.getElementsByTagName('revolutions');
     message = xmldoc[0].firstChild.nodeValue;
     document.getElementById('ssidaprate').value=message;
    }
   }
   function Motor(){
    server = "/Motor";
    request = new XMLHttpRequest();
    request.open("GET", server, true);
    request.send();
   }
   function load_time(){
    server = "/Time";
    request = new XMLHttpRequest();
    request.open("GET", server, true);
    request.send();
   }
   function Time_Zone(){
    timezone = document.getElementById('timezone').value;
    server = "/TimeZone?timezone="+timezone;
    request = new XMLHttpRequest();
    request.open("GET", server, true);
    request.send();
   }
   function set_Ssid(){
    ssid = document.getElementById('ssid').value;
    password = document.getElementById('password').value;
    server = "/ssid?ssid="+ssid+"&password="+password;
    request = new XMLHttpRequest();
    request.open("GET", server, true);
    request.send();
   }
   function set_SsidAP(){
    ssid = document.getElementById('ssidap').value;
    password = document.getElementById('passwordAp').value;
    server = "/ssidap?ssidAP="+ssid+"&passwordAP="+password;
    request = new XMLHttpRequest();
    request.open("GET", server, true);
    request.send();
   }
   function set_revolutions(){
    revolutions = document.getElementById('ssidaprate').value;
    server = "/revolutions?revolutions="+revolutions;
    request = new XMLHttpRequest();
    request.open("GET", server, true);
    request.send();
   }
    function kolibr(){
    kolibr = document.getElementById('kolibr').value;
    server = "/kolibr?kolibr="+kolibr;
    request = new XMLHttpRequest();
    request.open("GET", server, true);
    request.send();
   }
  </script>
  <style>
    input:invalid {
       border: 2px solid red !important;
    }
    input:invalid + input[type=submit] {
      pointer-events:none;
      opacity: 0.5;
     }
   </style>
 </head>
 <body onload="load();">
  <div class="container">
   <div class="row">
    <div class="col-md-offset-2 col-md-8" style="text-align:center;">
     <h1>Дополнительные настройки</h1>
     <div class="alert alert-dismissible alert-danger">Пожалуйста укажите ниже ваше GMT зону и подключитель к своему роутеру.
      Это позволит унавать время, которое будит синхранизируется 1 раз в сутки по вашему роутеру.</div>
     <h2>Временная зона GMT</h2>
     <input id="timezone" value="0" pattern="[0-9]{1,3}" class="form-control">
     <input class="btn btn-block btn-lg btn-success" name="Set_Time_Zone" value="Сохранить" onclick="Time_Zone();" type="submit">
     <h2>Подключиться к WiFi сети</h2>
     <input id="ssid" value="" class="form-control" pattern="[0-9a-zA-Z.]{1,15}" placeholder="Имя WiFi сети">
     <input id="password" value="" pattern="[0-9a-zA-Z.]{8,15}" class="form-control" placeholder="Пароль">
     <input class="btn btn-block btn-lg btn-success" name="Set_ssid" value="Сохранить" onclick="set_Ssid();" type="submit">
     <input class="btn btn-block btn-lg btn-primary" name="Motor" value="Синхронизировать время" onclick="load_time();" type="submit">
     <hr>
     <div class="alert alert-dismissible alert-info">Ниже вы можете указать новое название Wi-Fi жалюзи, пароль и настроить скорость вращения двигателя.</div>
     <h2>WiFi Жалюзи</h2>
     <input id="ssidap" value="" class="form-control" pattern="[0-9a-zA-Z.]{1,15}" placeholder="Имя WiFi сети">
     <input id="passwordAp" value="" pattern="[0-9a-zA-Z.]{8,15}" class="form-control" placeholder="Пароль">
     <input class="btn btn-block btn-lg btn-success" name="set_ssidAP" value="Сохранить" onclick="set_SsidAP();" type="submit">
     <hr>
     <h2>Время за которое жалюзи спуститься и подимется</h2>
     <input id="ssidaprate" value="90" pattern="[0-9]{1,2}" class="form-control">
     <input class="btn btn-block btn-lg btn-success" name="set_revolutions" value="Сохранить" onclick="set_revolutions();" type="submit">
     <hr>
     <h2>Время за которое жалюзи спуститься и подимется</h2>
     <input id="kolibr" value="90" pattern="[0-9]{1,2}" class="form-control">
     <input class="btn btn-block btn-lg btn-success" name="kolibr" value="Сохранить" onclick="kolibr();" type="submit">
     <hr>
     <a class="btn btn-block btn-lg btn-default" style="margin-bottom:50px;" href="./index.htm">Страница управления</a>
    </div>
   </div>
  </div>
 </body>
</html>
