<!DOCTYPE html>
<html>
 <head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <script type="text/javascript" src="js/function.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Options page</title>
  <script type="text/javascript">
   function handleServerResponse(){
    if (jsonResponse.state=='0') {blockval=jsonResponse.LangOn;} else {blockval=jsonResponse.LangOff;}
    val('off-on', blockval);
    LoadLang(jsonResponse.lang);
   }
   function motor(submit){
    server = "/motor";
    document.getElementById('url1').innerHTML='<a href="http://'+document.domain+server+'" target="_blank">http://'+document.domain+server+'</a>';
    if(navigator.onLine) {
     xhr = new XMLHttpRequest();
     xhr.open("GET","https://api.ipify.org?format=text",true);
     xhr.onload = function () {
      if (xhr.readyState === xhr.DONE) {
       if (xhr.status === 200) {
        document.getElementById('url2').innerHTML='<a href="http://'+(jsonResponse.DDNSName?(jsonResponse.DDNSName+':'+jsonResponse.DDNSPort+server):xhr.responseText+':'+jsonResponse.DDNSPort+server)+'" target="_blank">http://'+(jsonResponse.DDNSName?(jsonResponse.DDNSName+':'+jsonResponse.DDNSPort+server):xhr.responseText+':'+jsonResponse.DDNSPort+server)+'</a>';
       }
      }
     };
     xhr.send(null);
    }
    send_request(submit,server);
   }
  </script>
 </head>
 <body onload="load('first');">
  <div class="container">
   <div class="row hidden" id="content">
    <h1 id="title">{{LangOptions1}}</h1>
    <div class="col-sm-offset-2 col-sm-8 col-md-offset-3 col-md-6">
     <h5 class="alert-success">{{SSDP}}</h5>
     <select class="btn btn-default" id="language" onchange="language(this);">
      <option value="en">{{lang}}</option>
     </select>
     <a class="btn btn-block btn-danger" href="/">{{LangDevices}}</a>
     <a class="btn btn-block btn-default" href="/setup.htm">{{LangSetting3}}</a>
     <hr>
     <div class="alert alert-dismissible alert-info {{g2342}}"><button class="close" onclick="setCookie('g2342','hidden',365,this);" type="button">×</button>{{LangIfttt1}}<span id="hide" class="hidden">{{LangIfttt2}}</span></div>
     <input class="btn btn-block btn-lg btn-primary" id="off-on" value="{{LangOnOff}}" onclick="motor(this);" type="button">
     <hr>
     <div class="alert alert-dismissible alert-warning {{g57234}}"><button class="close" onclick="setCookie('g57234','hidden',365,this);" type="button">×</button>{{LangTime6}}</div>
     <h2>{{LangTime3}}</h2>
     <div class="row">
      <div class="col-sm-7">
       <h4>{{LangTime4}}</h4>
       <input id="open" value="{{TimeUp}}" pattern="(0[0-9]|1[0-9]|2[0-3])(:[0-5][0-9]){2}" class="form-control" placeholder="{{LangExample}}: 07:10:30">
       <div style="width:100%" class="btn-group">
        <input class="btn btn-block btn-success" value="{{LangSave}}" onclick="send_request(this,'/TimeUp?open='+val('open'));" type="button" style="width:70%">
        <input type="button" onclick="val('open',' ');send_request(this,'/TimeUp?open='+val('open'));" value="{{LangOff.}}" style="width:30%" class="btn btn-default">
       </div>
       <h4>{{LangTime5}}</h4>
       <input id="close" value="{{TimeDown}}" pattern="(0[0-9]|1[0-9]|2[0-3])(:[0-5][0-9]){2}" class="form-control" placeholder="{{LangExample}}: 07:10:30">
       <div style="width:100%" class="btn-group">
        <input class="btn btn-block btn-success" value="{{LangSave}}" onclick="send_request(this,'/TimeDown?close='+val('close'));" type="button" style="width:70%">
        <input type="button" onclick="close('close',' ');send_request(this,'/TimeDown?close='+val('close'));" value="{{LangOff.}}" style="width:30%" class="btn btn-default">
       </div>
      </div>
      <div class="col-sm-5">
       <h4>Время работы дв.:</h4>
       <div class="input-group">
        <input id="motor2" value="{{timeservo2}}" class="form-control" pattern="[0-9]*[.,]?[0-9]+">
        <span class="input-group-addon">{{LangSec}}</span>
       </div>
       <input class="btn btn-block btn-success" value="{{LangSave}}" onclick="send_request(this,'/Timeservo2?t='+val('motor2'));" type="button">
       <h4>Время работы дв.:</h4>
       <div class="input-group">
        <input id="motor" value="{{timeservo1}}" class="form-control" pattern="[0-9]*[.,]?[0-9]+">
        <span class="input-group-addon">{{LangSec}}</span>
       </div>
       <input class="btn btn-block btn-success" value="{{LangSave}}" onclick="send_request(this,'/Timeservo1?t='+val('motor'));" type="button">
      </div>
     </div>
     <hr>
     <h2>Обороты мотора</h2>
     <div class="row">
      <div class="col-sm-4">
       <input id="turn" value="{{turn}}" pattern="[0-9]{1,2}" class="form-control">
       <input class="btn btn-block btn-success" value="{{LangSave}}" onclick="send_request(this,'/turn?turn='+val('turn'));" type="button">
      </div>
      <div class="col-sm-8">
       <div class="alert alert-dismissible alert-info">Количество оборотов двигателя</div>
      </div>
     </div>
     <hr>
     <h2>Скорость вращения мотора</h2>
     <div class="row">
      <div class="col-sm-8">
       <div class="alert alert-dismissible alert-info">Как правило скорость мотора от 1 до 60. На больших скоростях ESP может некорректно работать.</div>
      </div>
      <div class="col-sm-4">
       <input id="speed" value="{{speed}}" pattern="[0-9]{1,2}" class="form-control">
       <input class="btn btn-block btn-success" value="{{LangSave}}" onclick="send_request(this,'/speed?speed='+val('speed'));" type="button">
      </div>
     </div>
     <hr>
     <h2>Колибровка мотора</h2>
     <div class="row">
      <div class="col-sm-4">
       <input id="calibration" value="{{calibration}}" pattern="[0-9]{1,2}" class="form-control">
       <input class="btn btn-block btn-success" value="{{LangSave}}" onclick="send_request(this,'/calibration?calibration='+val('calibration'));" type="button">
      </div>
      <div class="col-sm-8">
       <div class="alert alert-dismissible alert-info">Если серво двигатель постоянно крутится его необходимо отколибровать. Поэксперементируйте здесь с цифрами. Как правило они калеблятся от 90 до 95.</div>
      </div>
     </div>
     <hr>
     <a class="btn btn-block btn-default" href="/setup.htm">{{LangSetting3}}</a>
    </div>
   </div>
  </div>
 </body>
</html>
